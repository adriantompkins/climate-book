

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Rainfall indices based on the Indian monsoon &#8212; Earth System Modelling</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=365ca57ee442770a23c6" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=365ca57ee442770a23c6" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=365ca57ee442770a23c6" />
  <script src="../../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=365ca57ee442770a23c6"></script>

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/part2_cda/climdata_gpgp_indices';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Correlation and Covariance" href="climdata_correlation_covariance.html" />
    <link rel="prev" title="Breakpoint analysis (segmentation analysis)" href="climdata_breakpoint_analysis.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
  
    <p class="title logo__title">Earth System Modelling</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Thermodynamics and Physics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../content_radiation.html">Chapter 2: Energy Balance and Forcing</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../part1_tpa/radn_orbital.html">Orbital variations, insolation, and the ice ages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../part1_tpa/radn_radeq.html">Radiative Equilibrium</a></li>
<li class="toctree-l2"><a class="reference internal" href="../part1_tpa/radn_rce.html">Radiative-Convective Equilibrium</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Climate Data Analysis</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../content_clima_data.html">Chapter 2: Energy Balance and Forcing</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="climdata_trends_timeseries.html">Trend derivation</a></li>


<li class="toctree-l2"><a class="reference internal" href="climdata_breakpoint_analysis.html">Breakpoint analysis (segmentation analysis)</a></li>




<li class="toctree-l2 current active"><a class="current reference internal" href="#">Rainfall indices based on the Indian monsoon</a></li>





<li class="toctree-l2"><a class="reference internal" href="climdata_correlation_covariance.html">Correlation and Covariance</a></li>





<li class="toctree-l2"><a class="reference internal" href="climdata_FFT_analysis.html">Introduction to DDT analysis</a></li>

<li class="toctree-l2"><a class="reference internal" href="climdata_EOF1.html">EOF analysis</a></li>



<li class="toctree-l2"><a class="reference internal" href="climdata_linear_stability_analysis.html">Larvae-Vector System: Stability Analysis and Temperature Dependence</a></li>



</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../content_modelling.html">Chapter 3: Climate models</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="mod_advection.html">Focus on advection</a></li>
<li class="toctree-l2"><a class="reference internal" href="mod_CMIP_IPCC_temperature_trends.html">Coupled Model Intercomparison Project (CMIP)</a></li>

<li class="toctree-l2"><a class="reference internal" href="mod_climate-system-models.html">The climate system and climate models</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/adriantompkins/climate-book.git/master?urlpath=tree/notebooks/part2_cda/climdata_gpgp_indices.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/adriantompkins/climate-book.git/blob/master/notebooks/part2_cda/climdata_gpgp_indices.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/adriantompkins/climate-book.git" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/adriantompkins/climate-book.git/issues/new?title=Issue%20on%20page%20%2Fnotebooks/part2_cda/climdata_gpgp_indices.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/notebooks/part2_cda/climdata_gpgp_indices.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Rainfall indices based on the Indian monsoon</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Rainfall indices based on the Indian monsoon</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#cutting-out-areas">Cutting out areas</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#merging-files">Merging files</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#examine-the-files">Examine the files</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#spatial-averaging">Spatial averaging</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#now-we-can-start-to-use-cdo-to-calculate-more-interesting-indices">Now we can start to use CDO to calculate more interesting indices</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#task-1-a-wet-area-index">TASK 1:  A wet area index.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#task-2-number-of-extreme-rainy-days">TASK 2: Number of extreme rainy days</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#percentiles">Percentiles.</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#task-3-hands-on-homework">TASK 3 : Hands on/Homework</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#task-4-homework">TASK 4 : Homework</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="rainfall-indices-based-on-the-indian-monsoon">
<h1>Rainfall indices based on the Indian monsoon<a class="headerlink" href="#rainfall-indices-based-on-the-indian-monsoon" title="Permalink to this heading">#</a></h1>
<p>in this lesson we are going to apply some of the basics we have learned from the video course concerning the simple manipulation of netcdf files using cdo.  The examples are based on the analysis of the GPCP data.  To help you get the data fast to your machine I’ve placed a copy of an older version on my dods server, since accessing the latest version from NASA requires a time consuming registration process.  To see how to do this, <span class="xref myst">read this NASA page</span>. You can then replace this version of gpcp later if you desire.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># you need to install:</span>
<span class="c1"># MAC brew install (or port install)</span>
<span class="c1"># UBUNTU sudo apt install</span>
<span class="c1">#</span>
<span class="c1"># cdo</span>
<span class="c1"># wget</span>
<span class="c1"># ncview</span>
<span class="c1"># netcdf-dev (ubuntu) netcdf (brew)</span>

<span class="nv">year1</span><span class="o">=</span><span class="m">1998</span>
<span class="nv">year2</span><span class="o">=</span><span class="m">2005</span>
<span class="nv">ddir</span><span class="o">=</span><span class="s2">&quot;../../DATA/gpcp&quot;</span>
<span class="nv">fname</span><span class="o">=</span>gpcp_v01r03_daily_
</pre></div>
</div>
</div>
</div>
<p>here we pull the data from the ICTP server using wget…  But you can also follow my video course and write an API to get rainfall data from ERA5 or an alternative retrieval from the CDS if you prefer</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># get the data</span>

mkdir<span class="w"> </span>-p<span class="w"> </span>./gpcp
<span class="nv">stub</span><span class="o">=</span>gpcp_v01r03_daily_
<span class="k">for</span><span class="w"> </span>year<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="k">$(</span>seq<span class="w"> </span><span class="si">${</span><span class="nv">year1</span><span class="si">}</span><span class="w"> </span><span class="si">${</span><span class="nv">year2</span><span class="si">}</span><span class="k">)</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">   </span>wget<span class="w"> </span>-P<span class="w"> </span><span class="nv">$ddir</span><span class="w"> </span>http://clima-dods.ictp.it/Users/tompkins/Observations/GPCP/v1.3/<span class="si">${</span><span class="nv">stub</span><span class="si">}${</span><span class="nv">year</span><span class="si">}</span>.nc
<span class="k">done</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--2026-02-03 14:15:34--  http://clima-dods.ictp.it/Users/tompkins/Observations/GPCP/v1.3/gpcp_v01r03_daily_1998.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Resolving clima-dods.ictp.it (clima-dods.ictp.it)... 140.105.16.180
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Connecting to clima-dods.ictp.it (clima-dods.ictp.it)|140.105.16.180|:80... connected.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HTTP request sent, awaiting response... 200 OK
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Length: 94726499 (90M) [application/x-netcdf]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Saving to: ‘../../DATA/gpcp/gpcp_v01r03_daily_1998.nc.4’
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          gpcp_v01r   0%[                    ]       0  --.-KB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>         gpcp_v01r0   0%[                    ] 603.39K  2.95MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        gpcp_v01r03   1%[                    ]   1.78M  4.37MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       gpcp_v01r03_   3%[                    ]   3.14M  5.18MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      gpcp_v01r03_d   4%[                    ]   4.29M  4.99MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     gpcp_v01r03_da   6%[&gt;                   ]   6.27M  5.92MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    gpcp_v01r03_dai   8%[&gt;                   ]   7.61M  6.05MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   gpcp_v01r03_dail   9%[&gt;                   ]   8.92M  6.11MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  gpcp_v01r03_daily  11%[=&gt;                  ]  10.26M  6.18MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> gpcp_v01r03_daily_  12%[=&gt;                  ]  11.08M  5.88MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>gpcp_v01r03_daily_1  14%[=&gt;                  ]  13.01M  6.23MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pcp_v01r03_daily_19  15%[==&gt;                 ]  14.29M  6.25MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>cp_v01r03_daily_199  17%[==&gt;                 ]  15.41M  6.19MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>p_v01r03_daily_1998  18%[==&gt;                 ]  16.74M  6.22MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>_v01r03_daily_1998.  20%[===&gt;                ]  18.77M  6.49MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>v01r03_daily_1998.n  23%[===&gt;                ]  20.87M  6.75MB/s    eta 10s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>01r03_daily_1998.nc  25%[====&gt;               ]  22.99M  7.22MB/s    eta 10s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1r03_daily_1998.nc.  28%[====&gt;               ]  25.32M  7.57MB/s    eta 10s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r03_daily_1998.nc.4  30%[=====&gt;              ]  27.73M  7.91MB/s    eta 10s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>03_daily_1998.nc.4   32%[=====&gt;              ]  29.36M  8.03MB/s    eta 10s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3_daily_1998.nc.4    33%[=====&gt;              ]  30.43M  7.75MB/s    eta 8s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>_daily_1998.nc.4     34%[=====&gt;              ]  31.22M  7.65MB/s    eta 8s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>daily_1998.nc.4      35%[======&gt;             ]  32.42M  7.58MB/s    eta 8s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>aily_1998.nc.4       37%[======&gt;             ]  34.23M  7.72MB/s    eta 8s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ily_1998.nc.4        40%[=======&gt;            ]  36.20M  8.18MB/s    eta 8s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ly_1998.nc.4         42%[=======&gt;            ]  38.17M  8.15MB/s    eta 7s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>y_1998.nc.4          44%[=======&gt;            ]  40.13M  8.37MB/s    eta 7s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>_1998.nc.4           46%[========&gt;           ]  41.99M  8.67MB/s    eta 7s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1998.nc.4            48%[========&gt;           ]  44.00M  8.85MB/s    eta 7s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>998.nc.4             50%[=========&gt;          ]  45.95M  8.90MB/s    eta 7s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>98.nc.4              52%[=========&gt;          ]  47.34M  8.63MB/s    eta 6s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>8.nc.4               54%[=========&gt;          ]  49.16M  8.53MB/s    eta 6s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>.nc.4                56%[==========&gt;         ]  51.25M  8.46MB/s    eta 6s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>nc.4                 58%[==========&gt;         ]  52.83M  8.18MB/s    eta 6s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>c.4                  60%[===========&gt;        ]  55.02M  8.33MB/s    eta 6s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>.4                   63%[===========&gt;        ]  57.24M  8.59MB/s    eta 4s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4                    65%[============&gt;       ]  59.38M  9.27MB/s    eta 4s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                     67%[============&gt;       ]  61.20M  9.45MB/s    eta 4s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  g  70%[=============&gt;      ]  63.29M  9.62MB/s    eta 4s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                 gp  73%[=============&gt;      ]  65.96M  9.86MB/s    eta 4s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                gpc  75%[==============&gt;     ]  68.45M  10.0MB/s    eta 3s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               gpcp  77%[==============&gt;     ]  70.30M  10.0MB/s    eta 3s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>              gpcp_  79%[==============&gt;     ]  71.87M  9.86MB/s    eta 3s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>             gpcp_v  82%[===============&gt;    ]  74.11M  9.99MB/s    eta 3s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>            gpcp_v0  84%[===============&gt;    ]  76.30M  10.1MB/s    eta 3s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>           gpcp_v01  86%[================&gt;   ]  78.43M  10.1MB/s    eta 1s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          gpcp_v01r  89%[================&gt;   ]  80.60M  10.4MB/s    eta 1s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>         gpcp_v01r0  90%[=================&gt;  ]  82.07M  10.2MB/s    eta 1s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        gpcp_v01r03  92%[=================&gt;  ]  83.97M  10.2MB/s    eta 1s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       gpcp_v01r03_  94%[=================&gt;  ]  85.66M  10.1MB/s    eta 1s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      gpcp_v01r03_d  97%[==================&gt; ]  88.22M  10.3MB/s    eta 0s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>gpcp_v01r03_daily_1 100%[===================&gt;]  90.34M  10.4MB/s    in 10s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2026-02-03 14:15:44 (8.72 MB/s) - ‘../../DATA/gpcp/gpcp_v01r03_daily_1998.nc.4’ saved [94726499/94726499]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--2026-02-03 14:15:44--  http://clima-dods.ictp.it/Users/tompkins/Observations/GPCP/v1.3/gpcp_v01r03_daily_1999.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Resolving clima-dods.ictp.it (clima-dods.ictp.it)... 140.105.16.180
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Connecting to clima-dods.ictp.it (clima-dods.ictp.it)|140.105.16.180|:80... connected.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HTTP request sent, awaiting response... 200 OK
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Length: 94726499 (90M) [application/x-netcdf]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Saving to: ‘../../DATA/gpcp/gpcp_v01r03_daily_1999.nc.2’
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          gpcp_v01r   0%[                    ]       0  --.-KB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>         gpcp_v01r0   1%[                    ]   1.30M  6.41MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        gpcp_v01r03   3%[                    ]   3.47M  8.59MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       gpcp_v01r03_   6%[&gt;                   ]   5.75M  9.52MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      gpcp_v01r03_d   9%[&gt;                   ]   8.26M  10.3MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     gpcp_v01r03_da  11%[=&gt;                  ]  10.61M  10.6MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    gpcp_v01r03_dai  13%[=&gt;                  ]  12.07M  9.90MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   gpcp_v01r03_dail  15%[==&gt;                 ]  13.76M  9.70MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  gpcp_v01r03_daily  17%[==&gt;                 ]  15.47M  9.56MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> gpcp_v01r03_daily_  19%[==&gt;                 ]  17.97M  9.88MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>gpcp_v01r03_daily_1  22%[===&gt;                ]  20.46M  10.1MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pcp_v01r03_daily_19  25%[====&gt;               ]  22.72M  10.2MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>cp_v01r03_daily_199  27%[====&gt;               ]  24.96M  10.3MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>p_v01r03_daily_1999  29%[====&gt;               ]  26.32M  10.0MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>_v01r03_daily_1999.  31%[=====&gt;              ]  28.56M  10.1MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>v01r03_daily_1999.n  34%[=====&gt;              ]  30.74M  10.1MB/s    eta 6s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>01r03_daily_1999.nc  36%[======&gt;             ]  33.07M  10.2MB/s    eta 6s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1r03_daily_1999.nc.  39%[======&gt;             ]  35.57M  10.6MB/s    eta 6s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r03_daily_1999.nc.2  41%[=======&gt;            ]  37.32M  10.5MB/s    eta 6s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>03_daily_1999.nc.2   42%[=======&gt;            ]  38.71M  10.2MB/s    eta 6s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3_daily_1999.nc.2    45%[========&gt;           ]  40.93M  10.1MB/s    eta 5s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>_daily_1999.nc.2     48%[========&gt;           ]  43.63M  10.2MB/s    eta 5s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>daily_1999.nc.2      50%[=========&gt;          ]  45.81M  10.5MB/s    eta 5s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>aily_1999.nc.2       53%[=========&gt;          ]  48.18M  10.8MB/s    eta 5s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ily_1999.nc.2        55%[==========&gt;         ]  50.54M  10.9MB/s    eta 5s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ly_1999.nc.2         58%[==========&gt;         ]  53.15M  10.9MB/s    eta 4s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>y_1999.nc.2          61%[===========&gt;        ]  55.61M  10.9MB/s    eta 4s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>_1999.nc.2           63%[===========&gt;        ]  57.77M  10.9MB/s    eta 4s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1999.nc.2            66%[============&gt;       ]  59.98M  10.9MB/s    eta 4s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>999.nc.2             68%[============&gt;       ]  62.14M  11.1MB/s    eta 4s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>99.nc.2              71%[=============&gt;      ]  64.15M  11.1MB/s    eta 2s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>9.nc.2               73%[=============&gt;      ]  66.20M  11.0MB/s    eta 2s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>.nc.2                75%[==============&gt;     ]  68.46M  10.9MB/s    eta 2s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>nc.2                 78%[==============&gt;     ]  70.61M  10.9MB/s    eta 2s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>c.2                  80%[===============&gt;    ]  72.71M  11.1MB/s    eta 2s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>.2                   82%[===============&gt;    ]  74.82M  11.3MB/s    eta 1s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2                    85%[================&gt;   ]  77.48M  11.3MB/s    eta 1s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                     88%[================&gt;   ]  79.81M  11.2MB/s    eta 1s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  g  90%[=================&gt;  ]  82.16M  11.3MB/s    eta 1s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                 gp  93%[=================&gt;  ]  84.36M  11.2MB/s    eta 1s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                gpc  95%[==================&gt; ]  86.47M  11.1MB/s    eta 0s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               gpcp  98%[==================&gt; ]  88.66M  10.9MB/s    eta 0s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>gpcp_v01r03_daily_1 100%[===================&gt;]  90.34M  11.0MB/s    in 8.4s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2026-02-03 14:15:52 (10.7 MB/s) - ‘../../DATA/gpcp/gpcp_v01r03_daily_1999.nc.2’ saved [94726499/94726499]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--2026-02-03 14:15:52--  http://clima-dods.ictp.it/Users/tompkins/Observations/GPCP/v1.3/gpcp_v01r03_daily_2000.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Resolving clima-dods.ictp.it (clima-dods.ictp.it)... 140.105.16.180
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Connecting to clima-dods.ictp.it (clima-dods.ictp.it)|140.105.16.180|:80... connected.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HTTP request sent, awaiting response... 200 OK
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Length: 94985781 (91M) [application/x-netcdf]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Saving to: ‘../../DATA/gpcp/gpcp_v01r03_daily_2000.nc.1’
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          gpcp_v01r   0%[                    ]       0  --.-KB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>         gpcp_v01r0   0%[                    ] 899.31K  4.35MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        gpcp_v01r03   2%[                    ]   2.68M  6.59MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       gpcp_v01r03_   4%[                    ]   4.17M  6.85MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      gpcp_v01r03_d   6%[&gt;                   ]   6.17M  7.63MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     gpcp_v01r03_da   9%[&gt;                   ]   8.41M  8.33MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    gpcp_v01r03_dai  11%[=&gt;                  ]  10.86M  8.98MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   gpcp_v01r03_dail  14%[=&gt;                  ]  13.22M  9.37MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  gpcp_v01r03_daily  15%[==&gt;                 ]  14.41M  8.92MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> gpcp_v01r03_daily_  17%[==&gt;                 ]  15.87M  8.74MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>gpcp_v01r03_daily_2  19%[==&gt;                 ]  17.53M  8.69MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pcp_v01r03_daily_20  22%[===&gt;                ]  20.00M  9.01MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>cp_v01r03_daily_200  24%[===&gt;                ]  22.43M  9.27MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>p_v01r03_daily_2000  27%[====&gt;               ]  24.88M  9.50MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>_v01r03_daily_2000.  30%[=====&gt;              ]  27.27M  9.67MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>v01r03_daily_2000.n  32%[=====&gt;              ]  29.02M  9.59MB/s    eta 6s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>01r03_daily_2000.nc  33%[=====&gt;              ]  30.12M  9.33MB/s    eta 6s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1r03_daily_2000.nc.  34%[=====&gt;              ]  31.27M  9.44MB/s    eta 6s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r03_daily_2000.nc.1  37%[======&gt;             ]  33.54M  9.60MB/s    eta 6s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>03_daily_2000.nc.1   39%[======&gt;             ]  36.03M  9.89MB/s    eta 6s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3_daily_2000.nc.1    42%[=======&gt;            ]  38.42M  9.96MB/s    eta 5s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>_daily_2000.nc.1     45%[========&gt;           ]  40.84M  10.0MB/s    eta 5s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>daily_2000.nc.1      47%[========&gt;           ]  43.00M  9.96MB/s    eta 5s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>aily_2000.nc.1       48%[========&gt;           ]  44.17M  9.75MB/s    eta 5s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ily_2000.nc.1        50%[=========&gt;          ]  46.11M  9.86MB/s    eta 5s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ly_2000.nc.1         53%[=========&gt;          ]  48.41M  10.2MB/s    eta 4s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>y_2000.nc.1          56%[==========&gt;         ]  50.81M  10.2MB/s    eta 4s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>_2000.nc.1           58%[==========&gt;         ]  53.31M  10.3MB/s    eta 4s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2000.nc.1            61%[===========&gt;        ]  55.70M  10.3MB/s    eta 4s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>000.nc.1             63%[===========&gt;        ]  57.75M  10.1MB/s    eta 4s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>00.nc.1              65%[============&gt;       ]  59.31M  9.84MB/s    eta 3s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.nc.1               67%[============&gt;       ]  60.97M  9.92MB/s    eta 3s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>.nc.1                68%[============&gt;       ]  62.40M  10.1MB/s    eta 3s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>nc.1                 71%[=============&gt;      ]  64.70M  10.4MB/s    eta 3s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>c.1                  73%[=============&gt;      ]  67.01M  10.4MB/s    eta 3s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>.1                   76%[==============&gt;     ]  69.44M  10.4MB/s    eta 2s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1                    79%[==============&gt;     ]  71.87M  10.3MB/s    eta 2s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                     81%[===============&gt;    ]  74.22M  10.3MB/s    eta 2s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  g  84%[===============&gt;    ]  76.62M  10.5MB/s    eta 2s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                 gp  87%[================&gt;   ]  78.96M  10.9MB/s    eta 2s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                gpc  89%[================&gt;   ]  81.33M  10.9MB/s    eta 1s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               gpcp  92%[=================&gt;  ]  83.68M  11.0MB/s    eta 1s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>              gpcp_  94%[=================&gt;  ]  86.03M  10.9MB/s    eta 1s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>             gpcp_v  97%[==================&gt; ]  88.33M  10.9MB/s    eta 1s     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>gpcp_v01r03_daily_2 100%[===================&gt;]  90.58M  10.8MB/s    in 8.9s    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2026-02-03 14:16:01 (10.2 MB/s) - ‘../../DATA/gpcp/gpcp_v01r03_daily_2000.nc.1’ saved [94985781/94985781]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--2026-02-03 14:16:01--  http://clima-dods.ictp.it/Users/tompkins/Observations/GPCP/v1.3/gpcp_v01r03_daily_2001.nc
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Resolving clima-dods.ictp.it (clima-dods.ictp.it)... 140.105.16.180
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Connecting to clima-dods.ictp.it (clima-dods.ictp.it)|140.105.16.180|:80... connected.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HTTP request sent, awaiting response... 200 OK
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Length: 94726499 (90M) [application/x-netcdf]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Saving to: ‘../../DATA/gpcp/gpcp_v01r03_daily_2001.nc.1’
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          gpcp_v01r   0%[                    ]       0  --.-KB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>         gpcp_v01r0   1%[                    ] 980.24K  4.79MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        gpcp_v01r03   3%[                    ]   3.00M  7.49MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       gpcp_v01r03_   5%[&gt;                   ]   5.29M  8.80MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      gpcp_v01r03_d   8%[&gt;                   ]   7.71M  9.63MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     gpcp_v01r03_da  10%[=&gt;                  ]   9.91M  9.88MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    gpcp_v01r03_dai  12%[=&gt;                  ]  11.71M  9.69MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   gpcp_v01r03_dail  13%[=&gt;                  ]  12.53M  8.85MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  gpcp_v01r03_daily  15%[==&gt;                 ]  13.89M  8.58MB/s               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> gpcp_v01r03_daily_  17%[==&gt;                 ]  15.50M  8.52MB/s               
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="cutting-out-areas">
<h1>Cutting out areas<a class="headerlink" href="#cutting-out-areas" title="Permalink to this heading">#</a></h1>
<p>first of all we need to cut out an area, what is the CDO command that is used for this ?</p>
<details>
<summary>Click here for answer</summary>
The command we use is "sellonlatbox"
</details>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="c1"># Let&#39;s first cut out an area </span>
<span class="c1">#</span>
<span class="c1"># lon1, lon2, lat1, lat2</span>
<span class="nv">india</span><span class="o">=</span><span class="s2">&quot;65,90,8,27&quot;</span>
<span class="nv">wafrica</span><span class="o">=</span><span class="s2">&quot;-20,20,-5,30&quot;</span>

<span class="nv">region</span><span class="o">=</span><span class="nv">$india</span>
<span class="nv">region_tag</span><span class="o">=</span>_area<span class="k">$(</span><span class="nb">echo</span><span class="w"> </span><span class="nv">$region</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>tr<span class="w"> </span>,<span class="w"> </span>_<span class="k">)</span><span class="w"> </span>

<span class="k">for</span><span class="w"> </span>year<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="k">$(</span>seq<span class="w"> </span><span class="si">${</span><span class="nv">year1</span><span class="si">}</span><span class="w"> </span><span class="si">${</span><span class="nv">year2</span><span class="si">}</span><span class="k">)</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="nv">ifile</span><span class="o">=</span><span class="si">${</span><span class="nv">ddir</span><span class="si">}</span>/<span class="si">${</span><span class="nv">fname</span><span class="si">}${</span><span class="nv">year</span><span class="si">}</span>.nc
<span class="w">    </span><span class="nv">ofile</span><span class="o">=</span><span class="si">${</span><span class="nv">ddir</span><span class="si">}</span>/<span class="si">${</span><span class="nv">fname</span><span class="si">}${</span><span class="nv">year</span><span class="si">}${</span><span class="nv">region_tag</span><span class="si">}</span>.nc
<span class="w">    </span>cdo<span class="w"> </span>sellonlatbox,<span class="si">${</span><span class="nv">region</span><span class="si">}</span><span class="w"> </span><span class="nv">$ifile</span><span class="w"> </span><span class="nv">$ofile</span>
<span class="k">done</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Green">cdo    sellonlatbox: </span>Processed 23652000 values from 1 variable over 365 timesteps [0.08s 43MB]
<span class=" -Color -Color-Green">cdo    sellonlatbox: </span>Processed 23652000 values from 1 variable over 365 timesteps [0.07s 42MB]
<span class=" -Color -Color-Green">cdo    sellonlatbox: </span>Processed 23716800 values from 1 variable over 366 timesteps [0.07s 42MB]
<span class=" -Color -Color-Green">cdo    sellonlatbox: </span>Processed 23652000 values from 1 variable over 365 timesteps [0.06s 41MB]
<span class=" -Color -Color-Green">cdo    sellonlatbox: </span>Processed 23652000 values from 1 variable over 365 timesteps [0.06s 42MB]
<span class=" -Color -Color-Green">cdo    sellonlatbox: </span>Processed 23652000 values from 1 variable over 365 timesteps [0.07s 43MB]
<span class=" -Color -Color-Green">cdo    sellonlatbox: </span>Processed 23716800 values from 1 variable over 366 timesteps [0.07s 42MB]
<span class=" -Color -Color-Green">cdo    sellonlatbox: </span>Processed 23652000 values from 1 variable over 365 timesteps [0.06s 41MB]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">lon1</span><span class="o">=</span><span class="m">65</span>
<span class="nv">lon2</span><span class="o">=</span><span class="m">90</span>
<span class="nv">lat1</span><span class="o">=</span><span class="m">8</span>
<span class="nv">lat2</span><span class="o">=</span><span class="m">27</span>

<span class="nv">region</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">lon1</span><span class="si">}</span><span class="s2">,</span><span class="si">${</span><span class="nv">lon2</span><span class="si">}</span><span class="s2">,</span><span class="si">${</span><span class="nv">lat1</span><span class="si">}</span><span class="s2">,</span><span class="si">${</span><span class="nv">lat2</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="nv">region_tag</span><span class="o">=</span>area_<span class="si">${</span><span class="nv">lon1</span><span class="si">}</span>_<span class="si">${</span><span class="nv">lon2</span><span class="si">}</span>_<span class="si">${</span><span class="nv">lat1</span><span class="si">}</span>_<span class="si">${</span><span class="nv">lat2</span><span class="si">}</span>

<span class="k">for</span><span class="w"> </span>year<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="k">$(</span>seq<span class="w"> </span><span class="si">${</span><span class="nv">year1</span><span class="si">}</span><span class="w"> </span><span class="si">${</span><span class="nv">year2</span><span class="si">}</span><span class="k">)</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="nv">ifile</span><span class="o">=</span><span class="si">${</span><span class="nv">ddir</span><span class="si">}</span>/<span class="si">${</span><span class="nv">fname</span><span class="si">}${</span><span class="nv">year</span><span class="si">}</span>.nc
<span class="w">    </span><span class="nv">ofile</span><span class="o">=</span><span class="si">${</span><span class="nv">ddir</span><span class="si">}</span>/<span class="si">${</span><span class="nv">fname</span><span class="si">}${</span><span class="nv">year</span><span class="si">}</span>_<span class="si">${</span><span class="nv">region_tag</span><span class="si">}</span>.nc
<span class="w">    </span>cdo<span class="w"> </span>sellonlatbox,<span class="si">${</span><span class="nv">region</span><span class="si">}</span><span class="w"> </span><span class="nv">$ifile</span><span class="w"> </span><span class="nv">$ofile</span>
<span class="k">done</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Green">cdo    sellonlatbox: </span>Processed 23652000 values from 1 variable over 365 timesteps [0.08s 43MB]
<span class=" -Color -Color-Green">cdo    sellonlatbox: </span>Processed 23652000 values from 1 variable over 365 timesteps [0.07s 43MB]
<span class=" -Color -Color-Green">cdo    sellonlatbox: </span>Processed 23716800 values from 1 variable over 366 timesteps [0.07s 41MB]
<span class=" -Color -Color-Green">cdo    sellonlatbox: </span>Processed 23652000 values from 1 variable over 365 timesteps [0.07s 43MB]
<span class=" -Color -Color-Green">cdo    sellonlatbox: </span>Processed 23652000 values from 1 variable over 365 timesteps [0.07s 42MB]
<span class=" -Color -Color-Green">cdo    sellonlatbox: </span>Processed 23652000 values from 1 variable over 365 timesteps [0.07s 44MB]
<span class=" -Color -Color-Green">cdo    sellonlatbox: </span>Processed 23716800 values from 1 variable over 366 timesteps [0.07s 43MB]
<span class=" -Color -Color-Green">cdo    sellonlatbox: </span>Processed 23652000 values from 1 variable over 365 timesteps [0.07s 43MB]
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="merging-files">
<h1>Merging files<a class="headerlink" href="#merging-files" title="Permalink to this heading">#</a></h1>
<p>now we want to merge the files into a single file for the whole period and just select the summer months</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># now the files are much smaller, let&#39;s put them together in a single file for ease</span>
cdo<span class="w"> </span>-O<span class="w"> </span>mergetime<span class="w"> </span><span class="si">${</span><span class="nv">ddir</span><span class="si">}</span>/<span class="si">${</span><span class="nv">fname</span><span class="si">}</span>????<span class="si">${</span><span class="nv">region_tag</span><span class="si">}</span>.nc<span class="w"> </span><span class="si">${</span><span class="nv">ddir</span><span class="si">}</span>/<span class="si">${</span><span class="nv">fname</span><span class="si">}${</span><span class="nv">region_tag</span><span class="si">}</span>.nc

<span class="c1"># just select the summer months</span>
cdo<span class="w"> </span>-O<span class="w"> </span>selmon,6/9<span class="w"> </span><span class="si">${</span><span class="nv">ddir</span><span class="si">}</span>/<span class="si">${</span><span class="nv">fname</span><span class="si">}${</span><span class="nv">region_tag</span><span class="si">}</span>.nc<span class="w"> </span><span class="si">${</span><span class="nv">ddir</span><span class="si">}</span>/<span class="si">${</span><span class="nv">fname</span><span class="si">}${</span><span class="nv">region_tag</span><span class="si">}</span>_JJAS.nc
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Green">cdo    mergetime: </span>Processed 1519440 values from 8 variables over 2922 timesteps [0.32s 58MB]
<span class=" -Color -Color-Green">cdo    selmonth: </span>Processed 507520 values from 1 variable over 2922 timesteps [0.17s 48MB]
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="examine-the-files">
<h1>Examine the files<a class="headerlink" href="#examine-the-files" title="Permalink to this heading">#</a></h1>
<p>Let’s take a look at the resulting file with ncview</p>
<p>Once you are familiar with the details, let’s start to make some more involved indices</p>
<p>These follow <a class="reference external" href="https://arxiv.org/abs/2404.12419">https://arxiv.org/abs/2404.12419</a></p>
<p>We first calculate the anomaly of the annual rainy season.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># now we have a single file, let&#39;s look at the annual anomaly</span>
cdo<span class="w"> </span>timmean<span class="w"> </span><span class="si">${</span><span class="nv">ddir</span><span class="si">}</span>/<span class="si">${</span><span class="nv">fname</span><span class="si">}${</span><span class="nv">region_tag</span><span class="si">}</span>_JJAS.nc<span class="w"> </span><span class="si">${</span><span class="nv">ddir</span><span class="si">}</span>/<span class="si">${</span><span class="nv">fname</span><span class="si">}${</span><span class="nv">region_tag</span><span class="si">}</span>_JJAS_timmean.nc
cdo<span class="w"> </span>sub<span class="w"> </span><span class="si">${</span><span class="nv">ddir</span><span class="si">}</span>/<span class="si">${</span><span class="nv">fname</span><span class="si">}${</span><span class="nv">region_tag</span><span class="si">}</span>_JJAS.nc<span class="w"> </span><span class="si">${</span><span class="nv">ddir</span><span class="si">}</span>/<span class="si">${</span><span class="nv">fname</span><span class="si">}${</span><span class="nv">region_tag</span><span class="si">}</span>_JJAS_timmean.nc<span class="w"> </span><span class="si">${</span><span class="nv">ddir</span><span class="si">}</span>/<span class="si">${</span><span class="nv">fname</span><span class="si">}${</span><span class="nv">region_tag</span><span class="si">}</span>_JJAS_anom.nc
cdo<span class="w"> </span>yearmean<span class="w"> </span><span class="si">${</span><span class="nv">ddir</span><span class="si">}</span>/<span class="si">${</span><span class="nv">fname</span><span class="si">}${</span><span class="nv">region_tag</span><span class="si">}</span>_JJAS_anom.nc<span class="w"> </span><span class="si">${</span><span class="nv">ddir</span><span class="si">}</span>/<span class="si">${</span><span class="nv">fname</span><span class="si">}${</span><span class="nv">region_tag</span><span class="si">}</span>_JJAS_anom_yearmean.nc
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Green">cdo(1) timmean: </span>Process started
<span class=" -Color -Color-Green">cdo    sub: </span>Filling up stream2 &gt;(pipe1.4)&lt; by copying the first timestep.
<span class=" -Color -Color-Green">cdo    sub: </span>Processed 508040 values from 2 variables over 977 timesteps [0.18s 47MB]
<span class=" -Color -Color-Green">cdo    yearmean: </span>Processed 507520 values from 1 variable over 976 timesteps [0.07s 39MB]
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="spatial-averaging">
<h1>Spatial averaging<a class="headerlink" href="#spatial-averaging" title="Permalink to this heading">#</a></h1>
<p>The spatial average is actually not straightforward to calculate offline.  As is clear from the video, one needs to account for the grid cell size, which means with a regular lat-long grid, weighting for the cosine of the latitude. Luckily cdo accounts for different grid mesh sizes in its fldmean function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># let&#39;s make an all-region index</span>
cdo<span class="w"> </span>fldmean<span class="w"> </span><span class="si">${</span><span class="nv">ddir</span><span class="si">}</span>/<span class="si">${</span><span class="nv">fname</span><span class="si">}${</span><span class="nv">region_tag</span><span class="si">}</span>_JJAS_anom_yearmean.nc<span class="w"> </span><span class="si">${</span><span class="nv">ddir</span><span class="si">}</span>/<span class="si">${</span><span class="nv">fname</span><span class="si">}${</span><span class="nv">region_tag</span><span class="si">}</span>_JJAS_anom_meanindex.nc
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Green">cdo    fldmean: </span>Processed 4160 values from 1 variable over 8 timesteps [0.02s 33MB]
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="now-we-can-start-to-use-cdo-to-calculate-more-interesting-indices">
<h1>Now we can start to use CDO to calculate more interesting indices<a class="headerlink" href="#now-we-can-start-to-use-cdo-to-calculate-more-interesting-indices" title="Permalink to this heading">#</a></h1>
<section id="task-1-a-wet-area-index">
<h2>TASK 1:  A wet area index.<a class="headerlink" href="#task-1-a-wet-area-index" title="Permalink to this heading">#</a></h2>
<p>Take a moment to think about this before reading on. You need to use cdo to make the “wet-area” index, which is  the fraction of a region that has had a <b>positive</b> rainfall anomaly in a given particular year…</p>
<p>In order to do this you will need to use a logical function, like</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ge</span></code> (greater than or equal) which compares two fields and produces a 1 if the first field is larger than or equal to the second, 0 otherwise, or</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gtc</span></code> (greater than a constant), which requires an argument (e.g. <code class="docutils literal notranslate"><span class="pre">gec,5</span></code> no spaces!) which then gives a 1 if the input field is greater than the threshold.</p></li>
</ul>
<details>
<summary>Which of these two function do we need to use here?</summary>
Either can work!  We will need *gec* if we are to see if the anomaly is above zero.  But you don't need to calculate the anomaly necessarily, you could also use ```cdo ge``` to compare the annual mean precipitation directly to the climatology!
</details><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># now we can start to look at the wet area index</span>
<span class="c1"># first we set to 1 all points that are with a positive anomaly</span>
cdo<span class="w"> </span>gec,0<span class="w"> </span><span class="si">${</span><span class="nv">ddir</span><span class="si">}</span>/<span class="si">${</span><span class="nv">fname</span><span class="si">}${</span><span class="nv">region_tag</span><span class="si">}</span>_JJAS_anom_yearmean.nc<span class="w"> </span><span class="si">${</span><span class="nv">ddir</span><span class="si">}</span>/<span class="si">${</span><span class="nv">fname</span><span class="si">}${</span><span class="nv">region_tag</span><span class="si">}</span>_JJAS_anom_binary.nc

<span class="c1"># and now we can add up all the 1s to see what the wet area is</span>
cdo<span class="w"> </span>fldmean<span class="w"> </span><span class="si">${</span><span class="nv">ddir</span><span class="si">}</span>/<span class="si">${</span><span class="nv">fname</span><span class="si">}${</span><span class="nv">region_tag</span><span class="si">}</span>_JJAS_anom_binary.nc<span class="w"> </span><span class="si">${</span><span class="nv">ddir</span><span class="si">}</span>/<span class="si">${</span><span class="nv">fname</span><span class="si">}${</span><span class="nv">region_tag</span><span class="si">}</span>_JJAS_wetarea_index.nc
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Green">cdo    gec: </span>Processed 4160 values from 1 variable over 8 timesteps [0.02s 33MB]
<span class=" -Color -Color-Green">cdo    fldmean: </span>Processed 4160 values from 1 variable over 8 timesteps [0.02s 33MB]
</pre></div>
</div>
</div>
</div>
</section>
<section id="task-2-number-of-extreme-rainy-days">
<h2>TASK 2: Number of extreme rainy days<a class="headerlink" href="#task-2-number-of-extreme-rainy-days" title="Permalink to this heading">#</a></h2>
<p>In this task you will need to calculate first the 95th percentile of rainfall, and then sum up the number of days within the monsoon season each year that exceed this threshold for each location…</p>
</section>
<section id="percentiles">
<h2>Percentiles.<a class="headerlink" href="#percentiles" title="Permalink to this heading">#</a></h2>
<p>Let’s say you have a collection of <span class="math notranslate nohighlight">\(n\)</span> observations <span class="math notranslate nohighlight">\(o_i\)</span>.  The Xth percentile simply gives the threshold below which <span class="math notranslate nohighlight">\(X\)</span> % of the distribution lies.  Now if <span class="math notranslate nohighlight">\(n\)</span> is large, you could simply line up the number in ascending order and make the cut at the point where <span class="math notranslate nohighlight">\(X\)</span>% of the numbers are smaller than your chosen threshold.  However usually your sample is not large enough, in which case it is common to assume that the sampled values fit a common distribution (e.g. one might assume that they are Normally distributed).  The distribution can be fitted by various methods such as moment matching, and then the thresholds are derived from the fitted distribution.</p>
<p>CDO has a number of built-in options that are derived from the relevant python package scipy:</p>
<ul class="simple">
<li><p>nrank</p></li>
<li><p>nist</p></li>
<li><p>rtype8</p></li>
<li><p>linear</p></li>
<li><p>lower</p></li>
<li><p>higher</p></li>
<li><p>nearest</p></li>
<li><p>midpoint</p></li>
<li><p>inverted_cdf</p></li>
<li><p>averaged_inverted_cdf</p></li>
<li><p>closest_observation</p></li>
<li><p>interpolated_inverted_cdf</p></li>
<li><p>hazen</p></li>
<li><p>weibull</p></li>
<li><p>median_unbiased</p></li>
<li><p>normal_unbiased</p></li>
</ul>
<p>As you can see the list is long!  We will therefore not delve into the details here, but refer you to the <a class="reference external" href="https://code.mpimet.mpg.de/projects/cdo/embedded/index.html#x1-520001.10">cdo percentile documentation</a> for this method.  For large samples, there is very little difference between the methods. We simply use the default method in the following.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># make a index for extremes P95 for example</span>
<span class="nv">ifile</span><span class="o">=</span><span class="si">${</span><span class="nv">ddir</span><span class="si">}</span>/<span class="si">${</span><span class="nv">fname</span><span class="si">}${</span><span class="nv">region_tag</span><span class="si">}</span>_JJAS.nc
<span class="nv">percen</span><span class="o">=</span><span class="m">95</span>
cdo<span class="w"> </span>timpctl,<span class="si">${</span><span class="nv">percen</span><span class="si">}</span><span class="w"> </span><span class="nv">$ifile</span><span class="w"> </span>-timmin<span class="w"> </span><span class="nv">$ifile</span><span class="w"> </span>-timmax<span class="w"> </span><span class="nv">$ifile</span><span class="w"> </span><span class="si">${</span><span class="nv">ddir</span><span class="si">}</span>/<span class="si">${</span><span class="nv">fname</span><span class="si">}${</span><span class="nv">region_tag</span><span class="si">}</span>_JJAS_p<span class="si">${</span><span class="nv">percen</span><span class="si">}</span>.nc

cdo<span class="w"> </span>ge<span class="w"> </span><span class="nv">$ifile</span><span class="w"> </span><span class="si">${</span><span class="nv">ddir</span><span class="si">}</span>/<span class="si">${</span><span class="nv">fname</span><span class="si">}${</span><span class="nv">region_tag</span><span class="si">}</span>_JJAS_p<span class="si">${</span><span class="nv">percen</span><span class="si">}</span>.nc<span class="w"> </span><span class="si">${</span><span class="nv">ddir</span><span class="si">}</span>/<span class="si">${</span><span class="nv">fname</span><span class="si">}${</span><span class="nv">region_tag</span><span class="si">}</span>_JJAS_p<span class="si">${</span><span class="nv">percen</span><span class="si">}</span>_binary.nc

<span class="c1"># number of extreme rainy days per year</span>
cdo<span class="w"> </span>yearsum<span class="w"> </span><span class="si">${</span><span class="nv">ddir</span><span class="si">}</span>/<span class="si">${</span><span class="nv">fname</span><span class="si">}${</span><span class="nv">region_tag</span><span class="si">}</span>_JJAS_p<span class="si">${</span><span class="nv">percen</span><span class="si">}</span>_binary.nc<span class="w"> </span><span class="si">${</span><span class="nv">ddir</span><span class="si">}</span>/<span class="si">${</span><span class="nv">fname</span><span class="si">}${</span><span class="nv">region_tag</span><span class="si">}</span>_JJAS_p<span class="si">${</span><span class="nv">percen</span><span class="si">}</span>_nevents.nc
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Green">cdo(1) timmin: </span>Process started
<span class=" -Color -Color-Green">cdo(2) timmax: </span>Process started
<span class=" -Color -Color-Green">cdo    timpctl: </span>Processed 508560 values from 3 variables over 978 timesteps [0.20s 50MB]
<span class=" -Color -Color-Green">cdo    ge: </span>Filling up stream2 &gt;../../DATA/gpcp/gpcp_v01r03_daily__area65_90_8_27_JJAS_p95.nc&lt; by copying the first timestep.
<span class=" -Color -Color-Green">cdo    ge: </span>Processed 508040 values from 2 variables over 977 timesteps [0.11s 44MB]
<span class=" -Color -Color-Green">cdo    yearsum: </span>Processed 507520 values from 1 variable over 976 timesteps [0.07s 38MB]
</pre></div>
</div>
</div>
</div>
<section id="task-3-hands-on-homework">
<h3>TASK 3 : Hands on/Homework<a class="headerlink" href="#task-3-hands-on-homework" title="Permalink to this heading">#</a></h3>
<p>Repeat the above exercises for another region that interests you, (e.g. West African monsoon, south American monsoon, Europe, take an area that interests you). Remember that if you cut down the seasons within the year to target the months when the rains arrive if you are focussing on a monsoon region!</p>
</section>
<section id="task-4-homework">
<h3>TASK 4 : Homework<a class="headerlink" href="#task-4-homework" title="Permalink to this heading">#</a></h3>
<p>Download from the dataserver SST data for the Pacific region, read up on the ENSO 3.4 index and think about how you could use CDO to make a simple ENSO index. This will be the topic of the next lecture, so don’t worry if you get stuck!</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "adriantompkins/climate-book.git",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "bash"
        },
        kernelOptions: {
            name: "bash",
            path: "./notebooks/part2_cda"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'bash'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="climdata_breakpoint_analysis.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Breakpoint analysis (segmentation analysis)</p>
      </div>
    </a>
    <a class="right-next"
       href="climdata_correlation_covariance.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Correlation and Covariance</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Rainfall indices based on the Indian monsoon</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#cutting-out-areas">Cutting out areas</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#merging-files">Merging files</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#examine-the-files">Examine the files</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#spatial-averaging">Spatial averaging</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#now-we-can-start-to-use-cdo-to-calculate-more-interesting-indices">Now we can start to use CDO to calculate more interesting indices</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#task-1-a-wet-area-index">TASK 1:  A wet area index.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#task-2-number-of-extreme-rainy-days">TASK 2: Number of extreme rainy days</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#percentiles">Percentiles.</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#task-3-hands-on-homework">TASK 3 : Hands on/Homework</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#task-4-homework">TASK 4 : Homework</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Adrian Tompkins
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=365ca57ee442770a23c6"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=365ca57ee442770a23c6"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>